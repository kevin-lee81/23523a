<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ì¶¤ ì œì‘ ì£¼ë¬¸ ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            padding: 40px;
            color: white;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .content {
            padding: 40px;
        }

        .form-section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group.full-width {
            grid-column: span 2;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input, 
        .form-group select, 
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus, 
        .form-group select:focus, 
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }

        .upload-area:hover {
            border-color: #764ba2;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .upload-area.dragging {
            border-color: #00d2ff;
            background: rgba(0, 210, 255, 0.1);
        }

        .upload-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 15px;
        }

        .file-list {
            background: white;
            border-radius: 8px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .price-display {
            background: linear-gradient(45deg, #00d2ff, #3a7bd5);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }

        .price-display h3 {
            margin-bottom: 10px;
        }

        .price-amount {
            font-size: 2rem;
            font-weight: bold;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d1edff;
            color: #0c5460;
            border: 1px solid #b6effb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .progress {
            width: 100%;
            height: 15px;
            background: #e9ecef;
            border-radius: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            width: 0%;
            transition: width 0.3s;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .form-group.full-width {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¨ ë§ì¶¤ ì œì‘ ì£¼ë¬¸</h1>
            <p>ë‹¹ì‹ ë§Œì˜ íŠ¹ë³„í•œ ì œí’ˆì„ ë§Œë“¤ì–´ë³´ì„¸ìš”</p>
        </div>

        <div class="content">
            <div id="alerts"></div>
            
            <form id="order-form">
                <!-- ì œí’ˆ ì‚¬ì–‘ ì„¹ì…˜ -->
                <div class="form-section">
                    <div class="section-title">
                        ğŸ“ ì œí’ˆ ì‚¬ì–‘
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>ğŸ“ ì‚¬ì´ì¦ˆ</label>
                            <select id="size" onchange="calculatePrice()" required>
                                <option value="">ì‚¬ì´ì¦ˆ ì„ íƒ</option>
                                <option value="small" data-price="10000">ì†Œí˜• (10cm x 10cm) - 10,000ì›</option>
                                <option value="medium" data-price="20000">ì¤‘í˜• (20cm x 20cm) - 20,000ì›</option>
                                <option value="large" data-price="30000">ëŒ€í˜• (30cm x 30cm) - 30,000ì›</option>
                                <option value="custom" data-price="0">ë§ì¶¤ ì‚¬ì´ì¦ˆ (ë³„ë„ ë¬¸ì˜)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>ğŸ¯ ì¬ì§ˆ</label>
                            <select id="material" onchange="calculatePrice()" required>
                                <option value="">ì¬ì§ˆ ì„ íƒ</option>
                                <option value="wood" data-price="5000">ì›ëª© (+5,000ì›)</option>
                                <option value="acrylic" data-price="3000">ì•„í¬ë¦´ (+3,000ì›)</option>
                                <option value="metal" data-price="8000">ê¸ˆì† (+8,000ì›)</option>
                                <option value="fabric" data-price="2000">íŒ¨ë¸Œë¦­ (+2,000ì›)</option>
                                <option value="plastic" data-price="1000">í”Œë¼ìŠ¤í‹± (+1,000ì›)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>ğŸ”¢ ìˆ˜ëŸ‰</label>
                            <select id="quantity" onchange="calculatePrice()" required>
                                <option value="">ìˆ˜ëŸ‰ ì„ íƒ</option>
                                <option value="1">1ê°œ</option>
                                <option value="2">2ê°œ</option>
                                <option value="3">3ê°œ</option>
                                <option value="5">5ê°œ</option>
                                <option value="10">10ê°œ</option>
                                <option value="custom">ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)</option>
                            </select>
                        </div>

                        <div class="form-group" id="custom-quantity-group" style="display: none;">
                            <label>ì§ì ‘ ì…ë ¥ ìˆ˜ëŸ‰</label>
                            <input type="number" id="custom-quantity" min="1" max="1000" onchange="calculatePrice()">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>âš¡ ì‘ì—… ì˜µì…˜</label>
                            <select id="work-option" onchange="calculatePrice()" required>
                                <option value="standard" data-price="0">ì¼ë°˜ ì‘ì—… (7-10ì¼)</option>
                                <option value="premium" data-price="10000">í”„ë¦¬ë¯¸ì—„ ì‘ì—… (+10,000ì›, 5-7ì¼)</option>
                                <option value="rush" data-price="25000">ê¸´ê¸‰ ì‘ì—… (+25,000ì›, 2-3ì¼)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>ğŸ¨ ìƒ‰ìƒ</label>
                            <select id="color">
                                <option value="">ìƒ‰ìƒ ì„ íƒ (ì„ íƒì‚¬í•­)</option>
                                <option value="natural">ìì—°ìƒ‰</option>
                                <option value="black">ë¸”ë™</option>
                                <option value="white">í™”ì´íŠ¸</option>
                                <option value="red">ë ˆë“œ</option>
                                <option value="blue">ë¸”ë£¨</option>
                                <option value="custom">ë§ì¶¤ ìƒ‰ìƒ (ë³„ë„ ë¬¸ì˜)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- íŒŒì¼ ì—…ë¡œë“œ ì„¹ì…˜ -->
                <div class="form-section">
                    <div class="section-title">
                        ğŸ“ ë””ìì¸ íŒŒì¼ ì—…ë¡œë“œ
                    </div>
                    
                    <div class="upload-area" onclick="document.getElementById('file-input').click()" 
                         ondragover="handleDragOver(event)" 
                         ondrop="handleDrop(event)" 
                         ondragenter="handleDragEnter(event)" 
                         ondragleave="handleDragLeave(event)">
                        <div class="upload-icon">â˜ï¸</div>
                        <h3>ë””ìì¸ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</h3>
                        <p>ì§€ì› í˜•ì‹: JPG, PNG, PDF, AI, PSD (ìµœëŒ€ 200MB)</p>
                        <input type="file" id="file-input" style="display: none;" 
                               onchange="handleFileSelect(event)" 
                               multiple 
                               accept=".jpg,.jpeg,.png,.pdf,.ai,.psd">
                    </div>

                    <div id="file-list" class="file-list" style="display: none;">
                        <!-- ì„ íƒëœ íŒŒì¼ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ê³ ê° ì •ë³´ ì„¹ì…˜ -->
                <div class="form-section">
                    <div class="section-title">
                        ğŸ‘¤ ê³ ê° ì •ë³´
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>ğŸ“ ì—°ë½ì²˜</label>
                            <input type="tel" id="contact" placeholder="010-1234-5678" required>
                        </div>

                        <div class="form-group">
                            <label>ğŸ“§ ì´ë©”ì¼</label>
                            <input type="email" id="email" placeholder="example@email.com">
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label>ğŸ“ íŠ¹ë³„ ìš”ì²­ì‚¬í•­</label>
                        <textarea id="special-request" rows="4" 
                                  placeholder="íŠ¹ë³„í•œ ìš”ì²­ì‚¬í•­ì´ë‚˜ ì„¸ë¶€ ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”..."></textarea>
                    </div>

                    <div class="form-group full-width">
                        <label>ğŸšš ë°°ì†¡ ì£¼ì†Œ (ì„ íƒì‚¬í•­)</label>
                        <textarea id="address" rows="3" 
                                  placeholder="ë°°ì†¡ì´ í•„ìš”í•œ ê²½ìš° ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”..."></textarea>
                    </div>
                </div>

                <!-- ê°€ê²© í‘œì‹œ -->
                <div class="price-display" id="price-display" style="display: none;">
                    <h3>ğŸ’° ì˜ˆìƒ ì œì‘ë¹„</h3>
                    <div class="price-amount" id="total-price">0ì›</div>
                    <p style="margin-top: 10px; font-size: 0.9rem;">* ìµœì¢… ê°€ê²©ì€ ë””ìì¸ ë³µì¡ë„ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                </div>

                <!-- ì—…ë¡œë“œ ì§„í–‰ìƒí™© -->
                <div id="upload-progress" style="display: none;">
                    <div class="progress">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <p id="progress-text">ì£¼ë¬¸ ì œì¶œ ì¤‘... 0%</p>
                </div>

                <!-- ì œì¶œ ë²„íŠ¼ -->
                <div style="text-align: center; margin-top: 30px;">
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">ğŸ”„ ì´ˆê¸°í™”</button>
                    <button type="submit" class="btn btn-primary">ğŸš€ ì£¼ë¬¸ ì œì¶œí•˜ê¸°</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        let basePrice = 0;
        let materialPrice = 0;
        let rushPrice = 0;
        let totalQuantity = 1;

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            calculatePrice();
        };

        // ìˆ˜ëŸ‰ ì„ íƒ ë³€ê²½ì‹œ
        document.getElementById('quantity').addEventListener('change', function() {
            const customGroup = document.getElementById('custom-quantity-group');
            if (this.value === 'custom') {
                customGroup.style.display = 'block';
            } else {
                customGroup.style.display = 'none';
                totalQuantity = parseInt(this.value) || 1;
            }
            calculatePrice();
        });

        // ë§ì¶¤ ìˆ˜ëŸ‰ ì…ë ¥ì‹œ
        document.getElementById('custom-quantity').addEventListener('input', function() {
            totalQuantity = parseInt(this.value) || 1;
            calculatePrice();
        });

        // ê°€ê²© ê³„ì‚°
        function calculatePrice() {
            const size = document.getElementById('size');
            const material = document.getElementById('material');
            const workOption = document.getElementById('work-option');
            
            basePrice = parseInt(size.selectedOptions[0]?.dataset?.price || 0);
            materialPrice = parseInt(material.selectedOptions[0]?.dataset?.price || 0);
            rushPrice = parseInt(workOption.selectedOptions[0]?.dataset?.price || 0);
            
            const total = (basePrice + materialPrice + rushPrice) * totalQuantity;
            
            if (total > 0) {
                document.getElementById('price-display').style.display = 'block';
                document.getElementById('total-price').textContent = total.toLocaleString() + 'ì›';
            } else {
                document.getElementById('price-display').style.display = 'none';
            }
        }

        // íŒŒì¼ ì„ íƒ ì²˜ë¦¬
        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            handleFiles(files);
        }

        function handleFiles(files) {
            selectedFiles = [...selectedFiles, ...files];
            displayFileList();
        }

        function displayFileList() {
            const fileList = document.getElementById('file-list');
            if (selectedFiles.length === 0) {
                fileList.style.display = 'none';
                return;
            }

            fileList.style.display = 'block';
            fileList.innerHTML = selectedFiles.map((file, index) => `
                <div class="file-item">
                    <div>
                        <strong>${file.name}</strong>
                        <small>(${(file.size / 1024 / 1024).toFixed(2)}MB)</small>
                    </div>
                    <button type="button" onclick="removeFile(${index})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 4px;">ì‚­ì œ</button>
                </div>
            `).join('');
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            displayFileList();
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
        function handleDragOver(e) { e.preventDefault(); }
        function handleDragEnter(e) { e.preventDefault(); e.target.closest('.upload-area').classList.add('dragging'); }
        function handleDragLeave(e) { e.preventDefault(); e.target.closest('.upload-area').classList.remove('dragging'); }
        function handleDrop(e) {
            e.preventDefault();
            e.target.closest('.upload-area').classList.remove('dragging');
            const files = Array.from(e.dataTransfer.files);
            handleFiles(files);
        }

        // í¼ ì œì¶œ
        document.getElementById('order-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (selectedFiles.length === 0) {
                showAlert('âŒ ë””ìì¸ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            const formData = {
                size: document.getElementById('size').value,
                material: document.getElementById('material').value,
                quantity: totalQuantity,
                workOption: document.getElementById('work-option').value,
                color: document.getElementById('color').value,
                contact: document.getElementById('contact').value,
                email: document.getElementById('email').value,
                specialRequest: document.getElementById('special-request').value,
                address: document.getElementById('address').value,
                totalPrice: (basePrice + materialPrice + rushPrice) * totalQuantity,
                files: selectedFiles
            };

            await submitOrder(formData);
        });

        // ì£¼ë¬¸ ì œì¶œ
        async function submitOrder(orderData) {
            document.getElementById('upload-progress').style.display = 'block';
            
            try {
                // TODO: ë°°í¬ëœ Cloudflare Workers URLë¡œ ë³€ê²½í•˜ì„¸ìš”
                const workerUrl = 'https://custom-order-system.your-subdomain.workers.dev/upload';
                
                for (let i = 0; i < orderData.files.length; i++) {
                    const file = orderData.files[i];
                    const progress = (i / orderData.files.length) * 100;
                    
                    document.getElementById('progress-bar').style.width = progress + '%';
                    document.getElementById('progress-text').textContent = `ì—…ë¡œë“œ ì¤‘... ${Math.round(progress)}%`;

                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('orderData', JSON.stringify(orderData));

                    const response = await fetch(workerUrl, {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        throw new Error('ì—…ë¡œë“œ ì‹¤íŒ¨');
                    }
                }

                document.getElementById('progress-bar').style.width = '100%';
                document.getElementById('progress-text').textContent = 'ì£¼ë¬¸ ì™„ë£Œ!';
                
                showAlert('ğŸ‰ ì£¼ë¬¸ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤! ê³§ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.', 'success');
                resetForm();

            } catch (error) {
                showAlert(`âŒ ì£¼ë¬¸ ì œì¶œ ì‹¤íŒ¨: ${error.message}`, 'error');
                document.getElementById('upload-progress').style.display = 'none';
            }
        }

        // í¼ ì´ˆê¸°í™”
        function resetForm() {
            document.getElementById('order-form').reset();
            selectedFiles = [];
            displayFileList();
            calculatePrice();
            document.getElementById('upload-progress').style.display = 'none';
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showAlert(message, type = 'success') {
            const alertsDiv = document.getElementById('alerts');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.innerHTML = message;
            alertsDiv.appendChild(alertDiv);
            
            setTimeout(() => alertDiv.remove(), 5000);
        }
    </script>
</body>
</html>
