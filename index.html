<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>파일 업로드 주문</title>
</head>
<body>
  <h1>주문 및 파일 업로드</h1>
  <form id="order-form">
    <label>사이즈:
      <select id="size" required>
        <option value="">선택</option>
        <option value="small">소형</option>
        <option value="medium">중형</option>
        <option value="large">대형</option>
      </select>
    </label><br/>

    <label>재질:
      <select id="material" required>
        <option value="">선택</option>
        <option value="wood">원목</option>
        <option value="metal">금속</option>
      </select>
    </label><br/>

    <label>수량:
      <input type="number" id="quantity" min="1" value="1" required />
    </label><br/>

    <label>연락처:
      <input type="text" id="contact" required />
    </label><br/>

    <label>이메일:
      <input type="email" id="email" />
    </label><br/>

    <label>디자인 파일:
      <input type="file" id="file" required />
    </label><br/>

    <button type="submit">제출</button>
  </form>

  <div id="message"></div>

  <script>
    const form = document.getElementById("order-form");
    const msg = document.getElementById("message");
    const workerUrl = "https://your-worker-subdomain.workers.dev/upload"; // 실제 배포 URL로 변경하세요

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const fileInput = document.getElementById("file");
      if (fileInput.files.length === 0) {
        msg.textContent = "파일을 선택하세요.";
        return;
      }

      const formData = new FormData();
      formData.append("file", fileInput.files[0]);

      const orderData = {
        size: document.getElementById("size").value,
        material: document.getElementById("material").value,
        quantity: document.getElementById("quantity").value,
        contact: document.getElementById("contact").value,
        email: document.getElementById("email").value,
      };

      formData.append("orderData", JSON.stringify(orderData));

      try {
        const res = await fetch(workerUrl, {
          method: "POST",
          body: formData,
        });

        const result = await res.json();

        if (result.success) {
          msg.textContent = "주문이 성공적으로 제출되었습니다.";
          form.reset();
        } else {
          msg.textContent = "오류가 발생했습니다: " + (result.error || "알 수 없는 오류");
        }
      } catch (err) {
        msg.textContent = "서버와 통신 중 오류가 발생했습니다.";
      }
    });
  </script>
</body>
</html>
